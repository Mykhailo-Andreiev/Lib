{% load static %}
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            gap: 10px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body class="page-archive">
<header class="main-header">
    <nav class="navbar">
        <div class="navbar-left">
            <a href="/" class="nav-link">–ì–æ–ª–æ–≤–Ω–∞</a>
            <a href="/books/" class="nav-link">–ö–∞—Ç–∞–ª–æ–≥</a>
            <a href="/archive/" class="nav-link">–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –∞—Ä—Ö—ñ–≤</a>
        </div>
        <div class="navbar-right">
            {% if user.is_authenticated %}
            <a href="{% url 'profile' %}" class="nav-link nav-user">üë§ {{ user.username }}</a>
            <a href="{% url 'logout' %}" class="nav-link">üö™ –í–∏–π—Ç–∏</a>
            {% else %}
            <a href="{% url 'login' %}" class="nav-link">üîë –í—Ö—ñ–¥</a>
            <a href="{% url 'register' %}" class="nav-link">üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
            {% endif %}
        </div>
    </nav>
</header>

<div class="archive-wrapper">
    <aside class="archive-sidebar">
        <h3>üìÅ –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</h3>
        <ul>
            <li><strong>–ù–∞—É–∫–æ–≤—ñ —Ä–æ–±–æ—Ç–∏</strong>
                <ul>
                    <li><a href="?category=–ù–∞—É–∫–æ–≤—ñ —Ä–æ–±–æ—Ç–∏&field=–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞">–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞</a></li>
                    <li><a href="?category=–ù–∞—É–∫–æ–≤—ñ —Ä–æ–±–æ—Ç–∏&field=–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</a></li>
                    <li><a href="?category=–ù–∞—É–∫–æ–≤—ñ —Ä–æ–±–æ—Ç–∏&field=–§—ñ–∑–∏–∫–∞">–§—ñ–∑–∏–∫–∞</a></li>
                </ul>
            </li>
            <li><strong>–°—Ç–∞—Ç—Ç—ñ</strong>
                <ul>
                    <li><a href="?category=–°—Ç–∞—Ç—Ç—ñ&field=–ï–∫–æ–Ω–æ–º—ñ–∫–∞">–ï–∫–æ–Ω–æ–º—ñ–∫–∞</a></li>
                    <li><a href="?category=–°—Ç–∞—Ç—Ç—ñ&field=–°–æ—Ü—ñ–æ–ª–æ–≥—ñ—è">–°–æ—Ü—ñ–æ–ª–æ–≥—ñ—è</a></li>
                </ul>
            </li>
        </ul>
    </aside>

    <main class="archive-content">
        <form method="get" class="archive-filter-form">
            <input type="text" name="q" placeholder="üîç –ü–æ—à—É–∫..." value="{{ request.GET.q }}">
            <select name="sort">
                <option value="">üîΩ –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è</option>
                <option value="year_asc" {% if request.GET.sort == 'year_asc' %}selected{% endif %}>–†—ñ–∫ (—Å–ø–æ—á–∞—Ç–∫—É —Å—Ç–∞—Ä—ñ)</option>
                <option value="year_desc" {% if request.GET.sort == 'year_desc' %}selected{% endif %}>–†—ñ–∫ (—Å–ø–æ—á–∞—Ç–∫—É –Ω–æ–≤—ñ)</option>
                <option value="pages_asc" {% if request.GET.sort == 'pages_asc' %}selected{% endif %}>–°—Ç–æ—Ä—ñ–Ω–∫–∏ (–º–µ–Ω—à–µ ‚Üí –±—ñ–ª—å—à–µ)</option>
                <option value="pages_desc" {% if request.GET.sort == 'pages_desc' %}selected{% endif %}>–°—Ç–æ—Ä—ñ–Ω–∫–∏ (–±—ñ–ª—å—à–µ ‚Üí –º–µ–Ω—à–µ)</option>
            </select>
            {% if request.GET.category %}
            <input type="hidden" name="category" value="{{ request.GET.category }}">
            {% endif %}
            {% if request.GET.field %}
            <input type="hidden" name="field" value="{{ request.GET.field }}">
            {% endif %}
            <button type="submit">–ü–æ—à—É–∫</button>
        </form>

        {% if documents %}
        <ul class="document-list">
            {% for doc in documents %}
            <li class="document-item">
                <h4>{{ doc.title }}</h4>
                <p><strong>–ê–≤—Ç–æ—Ä:</strong> {{ doc.author }}</p>
                <p><strong>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</strong> {{ doc.category }}</p>
                <p><strong>–ù–∞–ø—Ä—è–º:</strong> {{ doc.field }}</p>
                <p><strong>–†—ñ–∫ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó:</strong> {{ doc.year }}</p>
                <p><strong>–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–æ—Ä—ñ–Ω–æ–∫:</strong> {{ doc.pages }}</p>
                <p>{{ doc.description }}</p>
                <div class="button-group">
                    <a href="{{ doc.file.url }}" target="_blank" class="button view-btn">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏</a>
                    <a href="{{ doc.file.url }}" class="button download-btn" download>–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</a>
                </div>
            </li>
            {% endfor %}
        </ul>

        <div class="pagination">
            {% if documents.has_previous %}
            <a href="?page=1{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.field %}&field={{ request.GET.field }}{% endif %}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}">‚è™ –ü–µ—Ä—à–∞</a>
            <a href="?page={{ documents.previous_page_number }}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.field %}&field={{ request.GET.field }}{% endif %}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</a>
            {% endif %}
            <span>–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ documents.number }} –∑ {{ documents.paginator.num_pages }}</span>
            {% if documents.has_next %}
            <a href="?page={{ documents.next_page_number }}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.field %}&field={{ request.GET.field }}{% endif %}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}">‚û°Ô∏è –î–∞–ª—ñ</a>
            <a href="?page={{ documents.paginator.num_pages }}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}{% if request.GET.field %}&field={{ request.GET.field }}{% endif %}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}">‚è≠ –û—Å—Ç–∞–Ω–Ω—è</a>
            {% endif %}
        </div>
        {% else %}
        <p>üìç –î–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>
        {% endif %}
    </main>
</div>
</body>
</html>
