{% load static %}

<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body class="page-profile">

<header class="main-header">
    <nav class="navbar">
        <div class="navbar-left">
            <a href="/" class="nav-link">–ì–æ–ª–æ–≤–Ω–∞</a>
            <a href="/books/" class="nav-link">–ö–∞—Ç–∞–ª–æ–≥</a>
            <a href="/archive/" class="nav-link">–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –∞—Ä—Ö—ñ–≤</a>
        </div>

        <div class="navbar-right">
            {% if user.is_authenticated %}
            <a href="{% url 'profile' %}" class="nav-link nav-user">üë§ {{ user.username }}</a>
            <a href="{% url 'logout' %}" class="nav-link">üö™ –í–∏–π—Ç–∏</a>

            {% else %}
            <a href="{% url 'login' %}" class="nav-link">üîë –í—Ö—ñ–¥</a>
            <a href="{% url 'register' %}" class="nav-link">üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
            <a href="{% url 'register' %}" class="nav-link">üìù –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</a>
            {% endif %}
        </div>
    </nav>
</header>

<div class="container">
    <h2>üë§ –û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç</h2>

    <hr class="section-divider">

    <p><strong>–õ–æ–≥—ñ–Ω:</strong> {{ user.username }}</p>
    <p><strong>–Ü–º‚Äô—è:</strong> {{ user.first_name }}</p>
    <p><strong>–ü—Ä—ñ–∑–≤–∏—â–µ:</strong> {{ user.last_name }}</p>
    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ user.userprofile.phone }}</p>
    <p><strong>–°—Ç–∞—Ç—å:</strong> {{ user.userprofile.get_gender_display }}</p>

    <form action="{% url 'edit_profile' %}" method="get">
        <button type="submit" class="librarian-button-2">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</button>
    </form>



    {% if user.userprofile.is_librarian %}
    <hr class="section-divider">
    <div class="librarian-panel">
        <h3>–†–æ–∑–¥—ñ–ª –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞—Ä—è</h3>
        <form action="{% url 'librarian_bookings' %}" method="get">
            <button type="submit" class="librarian-button-2">–ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è</button>
        </form>
    </div>
    {% endif %}

    <hr class="section-divider">
    <h3>üìñ –ú–æ—ó –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è:</h3>
    {% if bookings %}
    <ul class="booking-history">
        {% for booking in bookings %}
        <li class="booking-entry">
            <div class="booking-item">
                <a href="{% url 'book_detail' booking.book.id %}" class="booking-link">
                    {% if booking.book.image %}
                    <img src="{{ booking.book.image.url }}" alt="{{ booking.book.title }}" class="booking-thumb">
                    {% else %}
                    <img src="{% static 'img/default_cover.jpg' %}" alt="No image" class="booking-thumb">
                    {% endif %}
                    <span class="booking-text">
                        {{ booking.book.title }} ‚Äî {{ booking.booking_date|date:"d.m.Y H:i" }}
                        <span>({{ booking.get_status_display }})</span>
                    </span>
                </a>
                {% if booking.status == 'active' %}
                <form method="post" action="{% url 'cancel_booking' booking.id %}" class="cancel-form">
                    {% csrf_token %}
                    <button type="submit" class="cancel-btn">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                </form>
                {% endif %}
            </div>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>üì≠ –ù–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö –±—Ä–æ–Ω—é–≤–∞–Ω—å.</p>
    {% endif %}
</div>

</body>
</html>
